<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-card/paper-card.html">

<link rel="import" href="./generic/app-localize-behavior.html">
<link rel="import" href="./generic/app-tag-manager-behaviour.html">

<link rel="import" href="./planet-kiosk-activity-behavior.html">

<dom-module id="planet-kiosk-activity">
  <template>
    <style>

      /** COMMON **/
      .card-container {
        color: black;
        text-decoration: none;
      }

      .card-container:active {
        transform: scale(0.98);
      }

      paper-card {
        display: block;
        border-radius: 1em;
        overflow: hidden;
        margin: 1.5em 0.6em;
      }

      paper-card h3 {
        font-size: 2.2em;
        line-height: 1.2em;
        font-family: var(--planet-font-family-heavy);
        color: var(--planet-color-theme-title);
        margin: 0.3em 0 0 0;
        overflow: hidden;
        display: -webkit-box;
        text-overflow: ellipsis;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
      }

      paper-card p.duration {
        color: var(--planet-color-theme-desc);
        @apply (--info-pres);
      }

      paper-card p.location {
        color: var(--planet-color-theme-sub);
        @apply (--info-pres);
      }

      paper-card p.price {
        font-size: 3em;
        font-family: var(--planet-font-family-heavy);
        color: var(--planet-color-theme-price);
      }

      /** COLUMN **/
      .card-container.column {
        display: inline-block;
        width: 30.6em;
      }

      .column paper-card {
        height: 38em;
      }

      .column paper-card .card-content {
        position: relative;
        padding: 0;
        height: 20em;
      }

      .column paper-card iron-image {
        width:30.6em;
        height:17.2em;
      }

      .column paper-card h3 {
        padding-left: 0.3em;
      }

      .column paper-card p.duration {
        margin: 0.764705882em 0 0 0;
      }

      .column paper-card p.location {
        margin: 0.235294118em 0 0 0;
      }

      .column paper-card p.price {
        position: absolute;
        bottom: 0;
        text-align: center;
        width: 100%;
        margin: 0 0 0.3em 0;
      }

      /** ROW **/
      .card-container.row {
        display: block;
      }

      .row paper-card {

      }

      .row div, .row iron-image {
        display: inline-block;
        vertical-align: top;
      }

      .row .card-content {
        width: 41em;
      }

      .row paper-card iron-image {
        width:22.61em;
        height:17em;
      }

      .row paper-card h3 {
        min-height: 2.1em;
      }

      .row paper-card p.duration {
        margin: 0;
        font-size: 2em;
        padding: 0.5em 0 0 0;
      }

      .row paper-card p.location {
        margin: 0;
        font-size: 2em;
        padding: 0.5em 0 0 0;
      }

      .row paper-card .price-container {
        text-align: right;
        width: 28em;
        height: 17em;
      }

      .row paper-card p.price {
        margin: 0;
        line-height: 5.5em;
      }

    </style>

    <a on-click="_clickHandler" class$="card-container [[display]]">
      <paper-card elevation="3">
        <iron-image src="[[activity.image.normal]]" sizing="cover" preload="" fade="" placeholder="./images/default_thumb_16x9.png">
        </iron-image>
        <div class="card-content">
          <h3>[[activity.title]]</h3>
          <p class="duration">[[_getDurationInterval(localize, activity)]][[_getFirstDuration(localize, activity)]]</p>
          <p class="location">[[_getAge(localize, activity)]] [[_getFirstLocation(activity)]]</p>
        </div>
        <div class="price-container">
          <template is="dom-if" if="[[_isFree(activity)]]">
            <p class="price">[[localize('activity_free')]]</p>
          </template>
          <template is="dom-if" if="[[!_isFree(activity)]]">
            <p class="price">[[_getFirstPrice(activity)]] [[localize('activity_currency')]]</p>
          </template>
        </div>
      </paper-card>
    </a>

  </template>


  <script>
    Polymer({
      is: 'planet-kiosk-activity',
      behaviors: [
        AppLocalizeBehavior,
        TagManagerBehavior,
        ActivityBehavior
      ],
      properties: {
        activity: {
          type: Object
        },
        display: {
          type: String
        }
      },      
      _clickHandler: function() {
        var activity = this.get('activity');        
        if (activity.dayIndex !== undefined) {
          globals.router.set('queryParams', {
            day: activity.dayIndex,
            hour: activity.hourIndex
          });
        }
        this.trackEvent('Activities selection - ' + globals.lastList, activity.code, activity.title, 'noevent');
        globals.router.set('route.path', '/detail/' + activity.code);
      }
    });
  </script>

</dom-module>